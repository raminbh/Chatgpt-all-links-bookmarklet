javascript:(async()=>{try{const linkGroups=new Map();const extractLinks=(element,sectionTitle)=>{const links=element.querySelectorAll('a[href]');links.forEach(link=>{if(link.href&&!link.href.startsWith('javascript:')&&link.href.includes('.')){const url=link.href;const text=link.textContent.trim()||url;if(!linkGroups.has(sectionTitle)){linkGroups.set(sectionTitle,[]);}linkGroups.get(sectionTitle).push({url,text});}});};const processSection=(section,title)=>{const headings=section.querySelectorAll('h1,h2,h3,h4,h5,h6');if(headings.length>0){headings.forEach(heading=>{const sectionTitle=heading.textContent.trim();let nextElement=heading.nextElementSibling;const sectionContent=document.createElement('div');while(nextElement&&!nextElement.matches('h1,h2,h3,h4,h5,h6')){sectionContent.appendChild(nextElement.cloneNode(true));nextElement=nextElement.nextElementSibling;}extractLinks(sectionContent,sectionTitle||title);});}else{extractLinks(section,title);}};const mainContent=document.querySelector('[data-message-author-role="assistant"]')||document.querySelector('main')||document.querySelector('[role="main"]')||document.body;const sections=mainContent.querySelectorAll('div');if(sections.length>0){sections.forEach((section,index)=>{const heading=section.querySelector('h1,h2,h3,h4,h5,h6');const title=heading?heading.textContent.trim():`Section ${index+1}`;processSection(section,title);});}else{processSection(mainContent,'Main Content');}const generalLinks=[];mainContent.querySelectorAll('a[href]').forEach(link=>{if(link.href&&!link.href.startsWith('javascript:')&&link.href.includes('.')){let found=false;for(let group of linkGroups.values()){if(group.some(item=>item.url===link.href)){found=true;break;}}if(!found){generalLinks.push({url:link.href,text:link.textContent.trim()||link.href});}}});if(generalLinks.length>0){linkGroups.set('Other Links',generalLinks);}if(linkGroups.size===0){alert('No links found on this page.');return;}const newTab=window.open('','_blank');const doc=newTab.document;doc.open();doc.close();const style=doc.createElement('style');style.textContent=`body{font-family:-apple-system,BlinkMacSystemFont,'Segoe UI',Roboto,sans-serif;max-width:1200px;margin:20px auto;padding:20px;background:linear-gradient(135deg,#667eea 0%,#764ba2 100%);min-height:100vh;}.header{display:flex;align-items:center;justify-content:space-between;margin-bottom:30px;background:rgba(255,255,255,0.95);padding:20px;border-radius:15px;box-shadow:0 8px 32px rgba(0,0,0,0.1);backdrop-filter:blur(10px);}.header-left h1{color:#2d3748;margin:0;font-size:28px;font-weight:700;}.header-right{display:flex;gap:10px;}.clipboard-btn{background:linear-gradient(135deg,#4299e1,#3182ce);color:white;border:none;padding:12px 20px;border-radius:8px;cursor:pointer;font-size:14px;font-weight:600;transition:all 0.3s;box-shadow:0 4px 15px rgba(66,153,225,0.4);}.clipboard-btn:hover{transform:translateY(-2px);box-shadow:0 8px 25px rgba(66,153,225,0.6);}.csv-btn{background:linear-gradient(135deg,#48bb78,#38a169);color:white;border:none;padding:12px 20px;border-radius:8px;cursor:pointer;font-size:14px;font-weight:600;transition:all 0.3s;box-shadow:0 4px 15px rgba(72,187,120,0.4);}.csv-btn:hover{transform:translateY(-2px);box-shadow:0 8px 25px rgba(72,187,120,0.6);}.success-toast{position:fixed;top:20px;right:20px;background:linear-gradient(135deg,#48bb78,#38a169);color:white;padding:15px 25px;border-radius:10px;box-shadow:0 8px 25px rgba(0,0,0,0.2);opacity:0;transform:translateX(100%);transition:all 0.3s ease;z-index:1000;font-weight:600;}.success-toast.show{opacity:1;transform:translateX(0);}.stats{background:rgba(255,255,255,0.9);padding:15px 20px;border-radius:10px;color:#4a5568;font-size:16px;font-weight:600;text-align:center;margin-bottom:25px;box-shadow:0 4px 15px rgba(0,0,0,0.1);}.section{background:rgba(255,255,255,0.95);margin:20px 0;padding:25px;border-radius:15px;box-shadow:0 8px 32px rgba(0,0,0,0.1);backdrop-filter:blur(10px);border:1px solid rgba(255,255,255,0.2);}.section h2{color:#2d3748;margin:0 0 20px 0;font-size:20px;font-weight:700;padding-bottom:10px;border-bottom:2px solid #e2e8f0;}.link-item{background:linear-gradient(135deg,#f7fafc,#edf2f7);margin:12px 0;padding:18px;border-radius:10px;border:1px solid #e2e8f0;transition:all 0.3s;cursor:pointer;}.link-item:hover{transform:translateY(-3px);box-shadow:0 8px 25px rgba(0,0,0,0.15);background:linear-gradient(135deg,#ffffff,#f7fafc);}.link-url{font-family:'SF Mono',Monaco,Menlo,monospace;color:#2d3748;font-size:13px;word-break:break-all;margin-bottom:8px;font-weight:600;}.link-text{color:#718096;font-size:12px;font-style:italic;}.link-item:hover .link-url{color:#4299e1;}.link-item:hover .link-text{color:#4a5568;}`;doc.head.appendChild(style);const toast=doc.createElement('div');toast.className='success-toast';toast.id='successToast';toast.textContent='Links copied to clipboard! ðŸ“‹';doc.body.appendChild(toast);const container=doc.createElement('div');const header=doc.createElement('div');header.className='header';const headerLeft=doc.createElement('div');headerLeft.className='header-left';const title=doc.createElement('h1');title.textContent='Extracted Links by Section';headerLeft.appendChild(title);const headerRight=doc.createElement('div');headerRight.className='header-right';const clipboardBtn=doc.createElement('button');clipboardBtn.className='clipboard-btn';clipboardBtn.innerHTML='ðŸ“‹ Copy All';clipboardBtn.addEventListener('click',()=>{let allText='';linkGroups.forEach((links,sectionTitle)=>{links.forEach(link=>{allText+=`${link.url}\n`;});});navigator.clipboard.writeText(allText.trim()).then(()=>{toast.textContent='Links copied! ðŸ“‹';toast.classList.add('show');setTimeout(()=>toast.classList.remove('show'),3000);}).catch(()=>{const textArea=doc.createElement('textarea');textArea.value=allText.trim();doc.body.appendChild(textArea);textArea.select();doc.execCommand('copy');doc.body.removeChild(textArea);toast.textContent='Links copied! ðŸ“‹';toast.classList.add('show');setTimeout(()=>toast.classList.remove('show'),3000);});});const csvBtn=doc.createElement('button');csvBtn.className='csv-btn';csvBtn.innerHTML='ðŸ“Š Export CSV';csvBtn.addEventListener('click',()=>{let csvContent='Section,URL,Title\n';linkGroups.forEach((links,sectionTitle)=>{links.forEach(link=>{const cleanSection=sectionTitle.replace(/"/g,'""');const cleanUrl=link.url.replace(/"/g,'""');const cleanText=link.text.replace(/"/g,'""');csvContent+=`"${cleanSection}","${cleanUrl}","${cleanText}"\n`;});});const blob=new Blob([csvContent],{type:'text/csv'});const url=URL.createObjectURL(blob);const a=doc.createElement('a');a.href=url;a.download='extracted-links.csv';a.click();URL.revokeObjectURL(url);toast.textContent='CSV exported! ðŸ“Š';toast.classList.add('show');setTimeout(()=>toast.classList.remove('show'),3000);});headerRight.appendChild(clipboardBtn);headerRight.appendChild(csvBtn);header.appendChild(headerLeft);header.appendChild(headerRight);container.appendChild(header);let totalLinks=0;linkGroups.forEach(links=>totalLinks+=links.length);const stats=doc.createElement('p');stats.className='stats';stats.textContent=`Found ${totalLinks} links across ${linkGroups.size} sections`;container.appendChild(stats);linkGroups.forEach((links,sectionTitle)=>{const section=doc.createElement('div');section.className='section';const sectionHeader=doc.createElement('h2');sectionHeader.textContent=`${sectionTitle} (${links.length} links)`;section.appendChild(sectionHeader);links.forEach(link=>{const item=doc.createElement('div');item.className='link-item';item.innerHTML=`<div class="link-url">${link.url}</div><div class="link-text">${link.text}</div>`;section.appendChild(item);});container.appendChild(section);});const footer=doc.createElement('div');footer.style.cssText='margin-top:40px;padding:20px;text-align:center;background:rgba(255,255,255,0.9);border-radius:10px;box-shadow:0 4px 15px rgba(0,0,0,0.1);';footer.innerHTML='<p style="margin:0;color:#4a5568;font-size:14px;">Created by <strong>Ramin Babaeihemmati</strong> â€¢ <a href="https://www.linkedin.com/in/ramin-babaei-hemmati/" target="_blank" style="color:#4299e1;text-decoration:none;font-weight:600;">Let\'s connect on LinkedIn!</a></p>';container.appendChild(footer);doc.body.appendChild(container);}catch(e){alert('Error extracting links: '+e.message);console.error(e);}})();